---
import Layout from '@layouts/LayoutEn.astro';
import Intro from '@components/career/section/Intro.astro';
import Position from '@components/career/section/Position.astro';
import ButtonJoin from '@components/career/parts/ButtonJoin.astro';
import CeoMessage from '@components/career/section/CeoMessage.astro';
import Interview from '@components/career/section/Interview.astro';
import OurData from '@components/career/section/OurData.astro';
import Navi from '@components/career/parts/Navi.astro';

const lang = 'en';

const pageMeta = {
  title: "Career",
};

// Career APIデータを取得
let careerData = null;
try {
  const response = await fetch('https://infocus.wp.site-prev2.com/api/career.json');
  const data = await response.json();
  careerData = data[0]; // 配列の最初の要素を取得
} catch (error) {
  console.error('Career data fetch error:', error);
}

// インタビューデータを抽出
const interviewData = careerData?.interview || [];
const careerPositions = careerData?.career || [];
---

<Layout
  title=""
  pageName="career"
  meta={pageMeta}
>

<div class="p-career-content">
  <div class="p-career-content__left" data-main-content>
    <div class="p-career-content__left-inner">
      <Intro />
      <Position lang={lang} positions={careerPositions} />
      <div class="sticky-btn">
        <ButtonJoin lang={lang} />
      </div>
    </div>
    <CeoMessage lang={lang} />
    <OurData />
    <Interview interviews={interviewData} />
  </div>
  <div class="p-career-content__right">
    <Navi lang={lang} />
  </div>
</div>

</Layout>

<style lang="scss" is:global>
@use '../../../assets/scss/mediaquery' as me;
@use '../../../assets/scss/mixin' as mi;

.p-career-content {
  display: grid;
  @include me.pc {
    grid-template-columns: 1fr 278px;
  }

  &__left {

    &-inner {
      @include me.sp {
        padding-block-end: 80px;
      }
    }
  }

  &__right {
    position: relative;
    width: 100%;
    height: 100%;
    padding-block-end: 90px;
    @include me.pc {
      border-left: solid 1px var(--c-white);
    }
    @include me.sp {
      display: none;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
  }
}

.sticky-btn {
  position: sticky;
  bottom: 100px;
  left: 20px;
  @include mi.z-contents(1);
  max-width: calc(100% - (20px * 2));
  @include me.pc {
    display: none;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }
}

</style>
